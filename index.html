<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Preface HR Assistant • n8n Chat (Apple Glass)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- n8n Chat base styles (CDN) -->
    <link
      href="https://cdn.jsdelivr.net/npm/@n8n/chat/dist/style.css"
      rel="stylesheet"
    />

    <!-- Apple-style liquid glass full-page layout + theme overrides -->
    <style>
      /* Reset / layout */
      html,
      body,
      #n8n-chat {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text',
          system-ui, 'Helvetica Neue', Arial, sans-serif;
        /* Subtle Apple-style gradient background */
        background: radial-gradient(circle at top left, #1f2937 0, #020617 60%);
        color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Center the chat widget and apply liquid glass look */
      #n8n-chat {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
        box-sizing: border-box;
      }

      /* Outer glass panel wrapping the actual chat widget */
      #n8n-chat .n8n-chat {
        width: min(960px, 100%);
        height: min(720px, 100%);

        background: radial-gradient(circle at top left,
            rgba(255, 255, 255, 0.32) 0,
            rgba(148, 163, 184, 0.24) 35%,
            rgba(15, 23, 42, 0.72) 100%);
        border-radius: 28px;
        border: 1px solid rgba(255, 255, 255, 0.38);
        box-shadow:
          0 24px 60px rgba(0, 0, 0, 0.6),
          0 0 0 1px rgba(15, 23, 42, 0.8);
        backdrop-filter: blur(26px) saturate(140%);
        -webkit-backdrop-filter: blur(26px) saturate(140%);
        overflow: hidden;
      }

      /* Slight padding inside so the chat doesn’t touch edges */
      #n8n-chat .n8n-chat__container,
      #n8n-chat .n8n-chat__wrapper {
        border-radius: 24px;
        overflow: hidden;
      }

      /* Header area tweaks if present */
      #n8n-chat .n8n-chat__header {
        background: linear-gradient(
          120deg,
          rgba(15, 23, 42, 0.96),
          rgba(30, 64, 175, 0.9)
        );
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.24);
      }

      #n8n-chat .n8n-chat__title {
        font-weight: 600;
        letter-spacing: 0.01em;
      }

      #n8n-chat .n8n-chat__subtitle {
        opacity: 0.9;
      }

      /* Messages area: glassy scroll area */
      #n8n-chat .n8n-chat__messages-container {
        background: linear-gradient(
          to bottom,
          rgba(15, 23, 42, 0.82),
          rgba(15, 23, 42, 0.92)
        );
      }

      /* Input bar glass treatment */
      #n8n-chat .n8n-chat__input-container {
        background: linear-gradient(
          135deg,
          rgba(15, 23, 42, 0.9),
          rgba(15, 23, 42, 0.96)
        );
        border-top: 1px solid rgba(148, 163, 184, 0.5);
        backdrop-filter: blur(22px);
        -webkit-backdrop-filter: blur(22px);
      }

      #n8n-chat textarea {
        background: rgba(15, 23, 42, 0.6);
        border-radius: 18px;
        border: 1px solid rgba(148, 163, 184, 0.8);
      }

      /* === All @n8n/chat CSS variables for color & shape tuning === */
      :root {
        /* Brand / primary */
        --chat--color-primary: #e5e7eb; /* header main text / primary buttons */
        --chat--color-primary-shade-50: #cbd5f5;
        --chat--color-primary-shade-100: #a5b4fc;

        /* Secondary / accent (user bubble) */
        --chat--color-secondary: rgba(129, 140, 248, 0.9);
        --chat--color-secondary-shade-50: rgba(79, 70, 229, 0.95);

        /* Base neutrals */
        --chat--color-white: rgba(255, 255, 255, 0.96);
        --chat--color-light: rgba(248, 250, 252, 0.7);
        --chat--color-light-shade-50: rgba(226, 232, 240, 0.72);
        --chat--color-light-shade-100: rgba(148, 163, 184, 0.8);
        --chat--color-medium: rgba(148, 163, 184, 0.9);
        --chat--color-dark: rgba(15, 23, 42, 0.96);
        --chat--color-disabled: rgba(148, 163, 184, 0.7);
        --chat--color-typing: rgba(148, 163, 184, 0.9);

        /* Shape & motion */
        --chat--spacing: 1rem;
        --chat--border-radius: 20px;
        --chat--transition-duration: 0.22s;

        /* Window size (for window mode; kept for completeness) */
        --chat--window--width: 400px;
        --chat--window--height: 600px;

        /* Textarea height */
        --chat--textarea--height: 64px;

        /* Bubbles */
        --chat--message--bot--background: rgba(15, 23, 42, 0.65);
        --chat--message--bot--color: rgba(226, 232, 240, 0.96);

        --chat--message--user--background: rgba(129, 140, 248, 0.95);
        --chat--message--user--color: #f9fafb;

        --chat--message--pre--background: rgba(15, 23, 42, 0.72);

        /* Floating toggle button (for window mode) */
        --chat--toggle--background: rgba(129, 140, 248, 0.98);
        --chat--toggle--hover--background: rgba(79, 70, 229, 0.98);
        --chat--toggle--active--background: rgba(55, 48, 163, 0.98);
        --chat--toggle--color: #f9fafb;
        --chat--toggle--size: 56px;
      }

      /* Small viewport tweaks */
      @media (max-width: 640px) {
        #n8n-chat {
          padding: 12px;
        }

        #n8n-chat .n8n-chat {
          width: 100%;
          height: 100%;
          border-radius: 20px;
        }
      }
    </style>
  </head>

  <body>
    <!-- Fullscreen target container for n8n chat -->
    <div
      id="n8n-chat"
      class="n8n-chat-fullscreen-container"
      aria-label="Preface HR Assistant chat"
    ></div>

    <!-- n8n Chat widget (CDN, ES module) -->
    <script type="module">
      import { createChat } from 'https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js';

      window.addEventListener('DOMContentLoaded', () => {
        createChat({
          /* =========================================
           *  Connection to your n8n HR Agent
           * ======================================= */

          // TODO: Replace with your real Chat Trigger webhook URL
          webhookUrl: 'https://derekpyyip.app.n8n.cloud/webhook/e2d69b7e-b0c1-46b5-9d6c-c41dc33bc2ad/chat',

          webhookConfig: {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-Chat-Source': 'preface-hr-assistant',
            },
          },

          // Mount point for the widget
          target: '#n8n-chat',

          // Full-page chat
          mode: 'fullscreen', // 'window' | 'fullscreen'

          // Keys used in the n8n workflow
          chatInputKey: 'chatInput',
          chatSessionKey: 'sessionId',

          // Extra metadata sent with every request (available in Chat Trigger input)
          metadata: {
            assistantId: 'preface-hr-assistant',
            department: 'HR',
            app: 'Preface Employee Portal',
          },

          // Show welcome screen before first message
          showWelcomeScreen: true,

          // Language + text
          defaultLanguage: 'en',
          initialMessages: [
            "Hi! I'm the Preface HR Assistant \ud83e\udd16",
            'You can ask me about leave, benefits, working hours, and any other HR policy.',
          ],
          i18n: {
            en: {
              title: 'Preface HR Assistant',
              subtitle: 'Ask me anything about HR policies and benefits.',
              footer:
                'Internal use only • For complex or sensitive topics, please contact HR directly.',
              getStarted: 'Start a new HR question',
              inputPlaceholder: 'Type your HR question…',
            },
          },
        });
      });
    </script>
  </body>
</html>
